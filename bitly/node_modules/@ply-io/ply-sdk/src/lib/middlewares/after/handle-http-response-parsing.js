const contentTypeHeader = 'Content-Type';
const contentTypesToBody = {
	'application/json': async function (response) {
		const json = await response.json();
		response.json = json;
		return response;
	},
	'text/': async function (response) {
		const text = await response.text();
		response.text = text;
		return response;
	}
};

const handleHttpResponseParsing = async function (response) {
	if (response && (response.status == 200 || response.status == 201)) {
		// valid response
		if (response.headers) {
			let header = response.headers.get(contentTypeHeader);
			if (header) {
				console.log(header);
				for (var type in contentTypesToBody) {
					if (header.includes(type)) {
						try {
							response = await contentTypesToBody[type](response);
						} catch (err) {
							console.log('err in response parsing: ', err);
						}
					}
				}
			}
		}
	}
	return response;
};
module.exports = handleHttpResponseParsing;
