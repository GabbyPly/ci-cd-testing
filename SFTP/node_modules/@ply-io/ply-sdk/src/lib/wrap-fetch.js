// https://github.com/benjamine/fetch-wrap

function extend(fetch, middleware, data) {
	data = data || {};
	if (!middleware || middleware.length < 1) {
		return fetch;
	}
	var innerFetch = middleware.length === 1 ? fetch : extend(fetch, middleware.slice(1), data);
	var next = middleware[0];
	return function extendedFetch(url, options) {
		// ensure options is always an object
		try {
			return Promise.resolve(next(url, options || {}, innerFetch, data));
		} catch (err) {
			return Promise.reject(err);
		}
	};
}

module.exports = extend;
